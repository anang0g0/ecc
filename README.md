# ecc

20200728

bigint.cの使い始めということもあり、まずは楕円曲線のパラメータを設定するプログラムを書いてみました。

bigint\sidh.c

bigint/sidh.cpp

です。

SIDHの仕様書。
1ページめから怒涛のアルゴリズム。
細かい計算とか考えると最終的に100くらいの関数を書くことになるのだろうか。
ネットで京大理学部卒の作家さんと、東大卒のエンジニアさんと話す機会があるのですが、暗号については数学者は興味がないしエンジニアには理解するのが難しい分野のようです。
東大出たんなら出来なくはないと思うのですが、必要性がないから書かないだけでしょうね。

20200727

http://cacr.uwaterloo.ca/techreports/2014/cacr2014-20.pdf

こんなに難しいのに、全然役に立たないなんて馬鹿にしてたら凄い活躍しててびっくり。
実はペアリングもわからないし、巨大整数も嫌いなんだけど、それじゃまるで逃げてるみたいだから癪に障る。

https://github.com/dconnolly/msr-sidh

いずれにしてもこういうコードが書けないと暗号技術者にはなれません。
更に定義体がECDLPの時のように素直じゃない。
二次の拡大体であるにもかかわらず、虚数が出てくることから、これが虚二次体上の整数論と関係があることに気付かないと意味不明なままです。
後、j-不変量なんてものも出てくるので要注意です。

https://github.com/Microsoft/PQCrypto-SIDH

こういう面倒なことはできるならやりたくない。
符号なら小さな数をたくさん集めるだけで安全な暗号になる。
何しろ符号は多項式と線形代数だけで作れるという分かりやすさがあるから、楕円曲線みたいな数学からの物体Xにならないんですよね。
それにどうせやるならみんなと同じことをやるんじゃなくて、やってないことをやる方が意味がある気がします。

符号も安全だけど、実は不器用なんだよね。
一つの暗号系でいろんなことが出来るペアリングとは対照的に、いまだに研究途中。
でもそれは多変数多項式系も同じようなもので、いまだに画期的で確実視されるような暗号はできていない。
そもそも多変数多項式でどうやって鍵共有できるのかという問題もある。
つまりペアリングベースの暗号が一番次世代に近い位置にあるわけ。

二日目にして早くもやる気をなくしている私。
もう符号があるから好きなときだけでいいやって感じ。
移植しても楕円なんでもうオワコンだし、やるんだったらSIDHだよねって感じで。
午前中で面倒になったｗ。

移植しようとするから悪いのだ。
どうせ全然違う方式だし計算式も変わっているのだから、1から作ればいいのだ。
やっぱり秘密鍵交換は必要だしね。

SIDHはかなりややこしい計算をしていて、関数だけでも50前後の数を書かないといけない。
しかも曲線のパラメーターが0と6の場合が有って、最新の情報だと６だけど、現存する実装では０になってたりする。
これはまだ、ドラフトの途中であることからこれからどんなふうに変わっていくかは確実じゃないからだ。
他の実装を見ても全部GMPを使っていて、やはり組み込みには使えない。
そして読んでもクソ長くて、でかいプログラム。
見るのもうんざりするけど書くのもうんざりするだろうなとｗ。
そして結論としては、やはり自分で納得の行くものを作る必要があるということ。
これは誰かのためになることでもあるだろうと、勝手に期待してしまうｗ。
ちょっと調査するから３日くらいしたら書き始めると思う。

20200726

自分は符号ベース暗号の支持者だけど、楕円曲線なら最終候補として妥協できる。
最悪、符号ベース暗号を秘密鍵で使うとかも考えている。

今回、巨大整数型を使えるようなプログラムを探していて、改めて誰かが使えるようにプログラムを書くということの大事さを知った気がする。
これはexample.cみたいなHowTOプログラムを書いておこうと思う。

git clone https://github.com/983/bigint

ところでSIDHなんですが、JavaScriptの実装もあるけど、どうも自分で使えそうな簡単な実装ではなく、現代的なオブジェクト指向で書かれてあるせいかどう使っていいのかさっぱり解らず。
というわけで、やはり昔作っておいたECCのプログラムを使うしかないという感じで、Cでの実装が終わったらjsも作って安心しておきたいと思うのであった。

20200725

弐号機再起動！楕円曲線の見事な復活というべきでしょうかｗ。

なんだかSIDHがものすごい勢いで実用化されていて、鍵交換どうしようかなーと迷っていたこともあって、秘密鍵暗号の設計がどうでも良くなりそうな感じです。

何だかいくらでも出てきそうな感じですが、楕円曲線が復活するとは思いませんでした。
中国の研究だと思ってたら、フランスの研究ですね。
この勢いで行くと、超楕円曲線も復活するかも知れないですね。
ちなみに超楕円曲線が超特異かどうかを知る方法は、つい最近までなかったらしい。

他の誰かが作った普通のCで書かれた巨大整数用プログラムを見つけたので、今後Pure C language で書き換えようと思ってます。
それで慣れてきたらいよいSIDHですかね。

今の所、NTL使って巨大整数を扱っているわけですが、まあ邪道ですねｗ。
組み込み環境みたいに言語が選べない人でちょっと面倒な人には、ちょうどいいプログラムがネットに落ちていたので、それを流用することに。
NTLも古いのしか使えないし。

確かに、SIDHだったらみんなが作っているようなので探せば実装はいくらでもある。
それがなかったからニーダーライター暗号を作れるように、自分用に作ったわけだけど。
SIDHなら鍵交換も、電子署名も、暗号化もできるし既存の方法よりはいろんなメリットがある。
でも、そこで私がまた自分のやり方で作る意味があるのか？という感じもする。
今更誰も使わないよね、っていう。
とりあえず知っておけば何かいいことがあるかもしれないという気がするだけ。
どうして急にやる気が出てきたかというと、楕円曲線周りは理論が難しいし、同種写像なんてものは聞いたことがないし、今から理解できる自信がなかったからだ。
でも、仕様書を見ると計算方法もパラメータも全部決まっているし、やっていることは楕円曲線とあまり変わりがない。
という訳で急に注目するようになったという感じだ。
このまま、古い楕円曲線を眠らせておくのはもったいないｗ。

すぐ欲しい人にはマイクロソフトが作ったSIDHがあるので、それを使うでしょうけど。

20200724

NTLはver 6.2.0以下を使ってください。
最新のやつを使うとエラーが出て、そもそもコンパイルできません。
自分が慣れてないだけかも知れないですが、コンパイルしても大量のリンクエラーが出てきてコンパイルに失敗します。
自分の環境で動かせるものとしてはver６くらいでした。

20200723

NTLを使いながら、SIDHを実装してみたいです。
本当なら符号を使った鍵交換がやりたいのですが、同じものばかりいじっていて少し飽きてきたので、SIDHにチャレンジしてみます。
未来の暗号はSIDHとニーダーライター暗号で決まりですね！

楕円曲線の使いみち。https://ja.wikipedia.org/wiki/%E8%B6%85%E7%89%B9%E7%95%B0%E5%90%8C%E7%A8%AE%E5%86%99%E5%83%8F%E3%83%87%E3%82%A3%E3%83%95%E3%82%A3%E3%83%BC%E3%83%BB%E3%83%98%E3%83%AB%E3%83%9E%E3%83%B3

これにあるとおり、同種写像というものがよくわからないが、この方法なら量子計算機にも対抗できる鍵交換ができるらしいです。
ProjectSelf（別のリポジトリ）のプログラムには、自分だけの暗号に使えそうな楕円曲線（自分の動機がそうだったためｗ）を構成するCM法の類数1の場合に限ったバージョンがあるので、それを使えばもしかするといい鍵生成になるかも知れません。
一般の場合の類数の場合は面倒なのでやっていません。
探さなくても、そのうちSIDH用のドラフトに出てくる曲線が決まるかも知れないですね。

ルビーで動かすコードも一時期一緒に公開してましたが、ProjectSelfのリポジトリとダブるのでルビーが得意な方はそちらをクローンしてください。

https://github.com/anang0g0/ProjectSelf

jsで動かせる楕円曲線のテストバージョンを公開しました。

2020？過去：
楕円曲線暗号とECDSAをドラフト見ながらこてこて作ってみました。動かすにはLinux上でNTLを使わないといけないです。
あれだけ話題になったのにRSAの代わりに使われることなく次世代暗号の座をほかの暗号方式に奪われてしまうなんて、意外と短命でしたねｗ
