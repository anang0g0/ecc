#! /usr/local/bin/ruby
# /root/ruby-1.6.8/sample/egsd.rb
# Created: Jul 28,2004
# Author: tcshacina
# $Id: egsd.rb,v 0.1 2004/07/28
# usage: ruby egsd.rb
# hint: Syndrome-Error table of Extend Golay Code

=begin
(23,12,7)-Golay Code generator function is
	G(x)=x^11+x^9+x^7+x^6+x^5+x+1.
=end



 @gr=[6547456,3273728,1636864,818432,409216,204608,102304,51152,25576,12788,6394,3197]
 @hr=[7973,15946,31892,63784,127568,255136,510272,1020544,2041088,4082176,8164352]


#/* [24,12,12]-ägí£ÉSÅ[ÉåÉCïÑçÜ */
@egc=[
0b100000000000110111000101,
0b010000000000011011100011,
0b001000000000101101110001,
0b000100000000010110111001,
0b000010000000001011011101,
0b000001000000000101101111,
0b000000100000100010110111,
0b000000010000110001011011,
0b000000001000111000101101,
0b000000000100011100010111,
0b000000000010101110001011,
0b000000000001111111111110
],
@ehc=[
0b101000111011100000000000,
0b110100011101010000000000,
0b011010001111001000000000,
0b101101000111000100000000,
0b110110100011000010000000,
0b111011010001000001000000,
0b011101101001000000100000,
0b001110110101000000010000,
0b000111011011000000001000,
0b100011101101000000000100,
0b010001110111000000000010,
0b111111111110000000000001
];


#/* [24,12,12]-ägí£ÉSÅ[ÉåÉCÅÕïÑçÜ */
@gt=[
  0b100000000000,
  0b010000000000,
  0b001000000000,
  0b000100000000,
  0b000010000000,
  0b000001000000,
  0b000000100000,
  0b000000010000,
  0b000000001000,
  0b000000000100,
  0b000000000010,
  0b000000000001,
  0b101000111011,
  0b110100011101,
  0b011010001111,
  0b101101000111,
  0b110110100011,
  0b111011010001,
  0b011101101001,
  0b001110110101,
  0b000111011011,
  0b100011101101,
  0b010001110111,
  0b111111111110]
@ht=[
  0b110111000101,
  0b011011100011,
  0b101101110001,
  0b010110111001,
  0b001011011101,
  0b000101101111,
  0b100010110111,
  0b110001011011,
  0b111000101101,
  0b011100010111,
  0b101110001011,
  0b111111111110,
  0b100000000000,
  0b010000000000,
  0b001000000000,
  0b000100000000,
  0b000010000000,
  0b000001000000,
  0b000000100000,
  0b000000010000,
  0b000000001000,
  0b000000000100,
  0b000000000010,
  0b000000000001]

#/* ëgçáÇπÇÃê∂ê¨ */


@N=24
@K=3
@count=0
@count2=0


def first(n) 
return ((1 << (n)) - 1)
end


@u=[32]
@ss=[256];
@model=0;
@Z=[0b1,0b01,0b001,0b0001,0b00001,0b000001,0b0000001,0b00000001,0b000000001,0b0000000001,
0b00000000001,0b000000000001,0b0000000000001,0b00000000000001,0b000000000000001,0b0000000000000001,
0b00000000000000001,0b000000000000000001,0b0000000000000000001,0b00000000000000000001,
0b000000000000000000001,0b0000000000000000000001,0b00000000000000000000001,
0b000000000000000000000001];
@v=[4096];



def nextset(x)

  
  smallest=x& -x;
  ripple=x+smallest;
  n_small=ripple & -ripple;
  ones=((n_small/smallest)>>1)-1;

  return ripple|ones;
end


def printest(s)

b=0
t=[24];


  for i in 1..@N-1
    if(s&1==1)
	@v[@count]=@v[@count]+@Z[i];
    end
    s >>= 1;
  end

@count=@count+1;
end


def err()

for i in 0..24
 @Z[i]= (1<<i);
end

for i in 0..4096
 @v[i]=0;
end

  @count=0;
  @count2=0;
  i=1; 
for k in 1..@K 
  x=first(k);
  while((x & ~first(@N))==0)
    printest(x);
    x=nextset(x);
    i=i+1;
  end
end

end


def m(y, z)


  c=0;
  while(y!=0)
    if(y&1==1)
	c ^=z;
    end
    z<<=1;
    y>>=1;
  end

  return c;  
end


def i2b(n)

k=0;

  for j in 0..@N-1
    if(n[j]==1)
      k=k+1
    end
  end

  return k%2;
end


def cb(x)

  i=0;
  while(x>0)
    x=(x>>1); i=i+1;
  end

  return i;
end



def main()

t=[12]
syn=[4096]

  h743=[
    0b0111100,
    0b1011010,
    0b1100110,
    0b0001111,
    0b0110011,
    0b1010101,
    0b1101001
  ]
  hh=[
    0b0001111,
    0b0110011,
    0b1010101
  ]

    for i in 0..@N-1
      l=@gt[i]
	print l,"\n"
	j=11
     while(j>-1)
       print l[j]
	j=j-1
     end
    print "\n"
  end
  
    for i in 0..@N-1
      m=@ht[i]
	j=11
	while(j>-1)
      	print m[j]
	j=j-1
    end
    print "\n"
  end

  err();

  for i in 0..@count-1
    print i,":",@v[i],"\n"
    syn[i]=0;
  end

for i in 0..@count-1
  a=0; x=0;
  for j in 0..11
    a=i2b(@v[i]&@ehc[j]);
    x=a+(x<<1);
  end
  syn[i]=x;
end

  for i in 0..@count-1
    print @v[i]," = ",syn[i],"\n"
  end

end

main()
