@GF=[0,1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142]
@FG=[0,1,2,26,3,51,27,199,4,224,52,239,28,105,200,76,5,101,225,15,53,142,240,130,29,194,106,249,201,9,77,114,6,139,102,48,226,37,16,34,54,148,143,219,241,19,131,70,30,182,195,126,107,40,250,186,202,155,10,121,78,229,115,167,7,192,140,99,103,222,49,254,227,153,38,180,17,146,35,137,55,209,149,207,144,151,220,190,242,211,20,93,132,57,71,65,31,67,183,164,196,73,127,111,108,59,41,85,251,134,187,62,203,95,156,160,11,22,122,44,79,213,230,173,116,244,168,88,8,113,193,248,141,129,100,14,104,75,223,238,50,198,255,25,228,166,154,120,39,185,181,125,18,69,147,218,36,33,138,47,56,64,210,92,150,189,208,206,145,136,152,179,221,253,191,98,243,87,212,172,21,43,94,159,133,61,58,84,72,110,66,163,32,46,68,217,184,124,165,119,197,24,74,237,128,13,112,247,109,162,60,83,42,158,86,171,252,97,135,178,188,205,63,91,204,90,96,177,157,170,161,82,12,246,23,236,123,118,45,216,80,175,214,234,231,232,174,233,117,215,245,235,169,81,89,176]
@h=Array.new(4){Array.new(16) {0}}
@temp=Array.new(4){Array.new(16) {0}}
@tmp=Array.new(4){Array.new(16) {0}}
@ss=Array.new(4){Array.new(16) {0}}
lo=[32]
ev=[16]
N=16
K=4
#@gf=[0,1,2,4,8,9,11,15,7,14,5,10,13,3,6,12]
#@fg=[0,1,2,13,3,10,14,8,4,5,11,6,15,12,9,7]
@gf=[0,1,2,4,8,3,6,12,11,5,10,7,14,15,13,9]
@fg=[0,1,2,5,3,9,6,11,4,15,10,8,7,14,12,13]

def index()

for i in 0..3
  @h[i][0]=1;
end

for i in 1..15
  @h[0][i]=1;
end
for i in 1..15
  @h[1][i]=i+1;
end
  for j in 2..2
    for i in 1..15
      @h[j][i]=mltn(j,i)+1;
    end
  end
#for k in 0..254
for j in 1..3
  for i in 1..15
    @h[j][i]=mlt(@h[j-1][i],@h[1][i]);
  end
end
#=begin
for i in 0..3
  for j in 0..14
    print @h[i][j]," "
  end
  print "\n"
end

end

def div(x, y)
    if(y==0)
	#/* printf("y‚ª0\n"); */
	#/* exit(1); */
    end
    if(x==0)
        return 0
    end
    return ((x-y+(N-1))%(N-1))+1
end


def mlt(x, y)

    if(x==0||y==0)
        return 0
    end
    return ((x+y-2)%(N-1))+1
end


def ml2(x,y)
  return (x+y)%(N-1)
end


def mltn(n, x)

if(x==0)
  return 1;
end
  i=x
  for j in 1..n
    i=mlt(i,x)
  end
  return i
end


def inv(x)
  return mltn(N-2,x)
end


def syn()
s=[0,0,0,0] #,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
s2=[64];
#err=[1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
err=[2,0,0,6,0,0,0,0,0,0,0,0,0,0,0]
for i in 0..3
  for j in 0..14
    s[i]^=@gf[mlt(@gf[err[j]],@h[i][j])];
  end
print @fg[s[i]]-1,","
end
print "\n"

for i in 0..3
  s[i]=mlt(@fg[s[i]],div(1,@fg[s[3]]));
  print s[i]-1,","
end


i=3;j=0;
while(i>-1)
  @temp[0][j]=s[i];
#  print @temp[0][i]," "
  i=i-1;j=j+1;
end

print "\n"

for j in 1..3
  for i in 0..(3-j)
    @temp[j][i]=@temp[j-1][i+1];
  end
end

print "\n"
alp=["a1","a2","a3","a4","a5","a6","a7","a8","b1","b2","b3","b4","b5","b6","b7","b8","c1","c2","c3","c4","c5","c6","c7","c8","d1","d2","d3","d4","d5","d6","d7","d8"]
for i in 0..2
  for j in 0..3
    print @temp[i][j],","
    @ss[i][j]=@temp[i][j];
  end
  print "\n"
end
  print "\n"
print @temp[2][0],"=",@temp[1][0],alp[0],"+",@temp[0][0],alp[1],"\n"
print @temp[2][1],"=",@temp[1][1],alp[0],"+",@temp[0][1],alp[1],"\n"
print @temp[2][2],"=",@temp[1][2],alp[0],"+",@temp[0][2],alp[1],"\n"

if(@temp[1][0]!=1)
  for a in 1..15
    b=mlt(a,@temp[1][0])
    if(b==1)
      @temp[1][0]=b;
      print @temp[1][0],","
      break;
    end
  end
  print a,"=",@temp[1][0],"\n"
end

  @temp[2][0]=mlt(@temp[2][0],a);
  @temp[0][0]=mlt(@temp[0][0],a);
  print @temp[2][0],",;",@temp[1][0],",",@temp[0][0],"\n\n"
  @tmp[2][0]=mlt(@temp[2][0],@temp[1][1]);
  @tmp[1][0]=@temp[1][1];
  @tmp[0][0]=mlt(@temp[0][0],@temp[1][1]);
  print @temp[2][0],"=",@temp[1][0],"a1+",@temp[0][0],"a2\n\n"
  @temp[2][1]=@fg[@gf[@temp[2][1]]^@gf[@tmp[2][0]]];
  @temp[1][1]=@fg[@gf[@temp[1][1]]^@gf[@tmp[1][0]]];
  @temp[0][1]=@fg[@gf[@temp[0][1]]^@gf[@tmp[0][0]]];
  print @temp[2][0],"=",@temp[1][0],"a1+",@temp[0][0],"a2\n"
  print @temp[2][1],"=",@temp[1][1],"a1+",@temp[0][1],"a2\n"
  print @temp[2][2],"=",@temp[1][2],"a1+",@temp[0][2],"a2\n"

if(@temp[0][1]!=1)
  for a in 1..15
    b=mlt(a,@temp[0][1])
    if(b==1)
      @temp[0][1]=b;
      print @temp[0][1],","
      break;
    end
  end
  print a,"=",@temp[0][1],"\n"
end

print @temp[0][0],"=temp00\n"

  @temp[2][1]=mlt(@temp[2][1],a);
  @temp[1][1]=mlt(@temp[1][1],a);
  print @temp[2][1],":,",@temp[1][1],",",@temp[0][1],"\n"

  @tmp[2][1]=mlt(@temp[2][1],@temp[0][0]);
  @tmp[1][1]=mlt(@temp[1][1],@temp[0][0]);
  @tmp[0][1]=@temp[0][0];
  @temp[2][0]=@fg[@gf[@temp[2][0]]^@gf[@tmp[2][1]]];
  @temp[1][0]=@fg[@gf[@temp[1][0]]^@gf[@tmp[1][1]]];
  @temp[0][0]=@fg[@gf[@temp[0][0]]^@gf[@tmp[0][1]]];
  print @temp[2][0],",",@temp[1][0],",",@temp[0][0],"\n"
a2=@temp[2][1];
a1=@temp[2][0];

c1=div(1,a2);
c2=div(a1,a2);
c3=div(a2,a2);
print c1,",",c2,",",c3,"\n"
w=[0,0,0,0]
xx=[0,0];j=0;
for x in 0..15
  if(@gf[mlt(c1,mlt(x,x))]^@gf[mlt(c2,x)]^@gf[c3]==0)
    print "x=",x,"\n"
    print "div=",div(1,x),"\n"
    xx[j]=div(1,x);
    j=j+1;
  end
end

for i in 0..1
  for j in 0..3
    @ss[i][j]=mlt(@ss[i][j],@temp[2][1-i]);
    w[j]^=@gf[@ss[i][j]];
  end
end
for i in 0..3
  print @fg[w[i]],","
end
print "\n"
for x in 0..1
  o=@fg[@gf[mlt(div(@fg[w[2]],a2),inv(xx[x]))]^@gf[div(@fg[w[3]],a2)]];
  l=@fg[1^@gf[mlt(xx[1-x],x)]];
  z=div(o,l);
  print @gf[z],"\n"
end
exit()

#=begin
k=0;
#while(k<3)
  for i in 0..3
    for j in 0..3
      print @FG[@temp[i][j]],","
    end
    print "\n"
    k=k+1;
  end
#end
print @fg[@gf[10]^@gf[2]],",",@fg[@gf[13]^@gf[3]],"@\n"
print @FG[@GF[51]^@GF[224]],"\n"
print @FG[@GF[137]^@GF[12]],"\n"
print @FG[@GF[88]^@GF[69]],"\n"
print div(1,79),",",div(218,79),"@\n"

for i in 1..4
  s2[i]=@fg[@gf[mlt(mlt(5,i),mlt(i,i))+1]^2]-1;

    print "i=",s2[i],","
end
print @FG[@GF[147]^1],"\n"
print @FG[@GF[51]^@GF[244]],"\n"

for x in 0..15
  if(@gf[(mlt(mlt(x,x),12)+1)%16]^@gf[(mlt(11,x)+1)%16]^1==0)
    print "x=",x,"\n"
  end
end

end

def gauss()

print "a\n"

end


index();
syn();

#print mltn(5,0);

